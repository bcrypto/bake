\section{Входные и выходные данные}\label{INOUT}

Входными данными протоколов BMQV, BSTS, BPACE являются 
параметры~$p$, $a$, $b$, $q$ и~$G$, 
которые описывают группу точек эллиптической кривой. 
Параметры должны удовлетворять требованиям, заданным в~\ref{COMMON.Params}. 
По модулю~$p$ определяется уровень стойкости~$\ell$ как минимальное 
натуральное, для которого $p<2^{2\ell}$.

Параметры эллиптической кривой могут согласовываться в 
приветственных сообщениях $\hello_A,\hello_B$ (см.~\ref{COMMON.Hello}),
которые также являются входными данными протоколов.

Кроме параметров эллиптической кривой и приветственных сообщений, 
входными данными протоколов~BMQV и~BSTS являются личные ключи~$d_A$, $d_B$ 
и сертификаты~$\Cert(Id_A,Q_A)$, $\Cert(Id_B,Q_B)$.
Ключи и сертификаты должны удовлетворять требованиям, 
заданным в~\ref{COMMON.Static}, \ref{COMMON.Cert}.

Кроме параметров эллиптической кривой и приветственных сообщений, 
входными данными протокола BPACE является общий пароль~$P\in\{0,1\}^{8*}$.

Выходными данными протоколов является либо общий
ключ~$K_0\in\{0,1\}^{256}$, либо признак~\texttt{ОШИБКА}. 
Возврат признака~\texttt{ОШИБКА} означает 
либо сбой при передаче сообщений протокола,
либо нарушение целостности сообщений,
либо нарушение их подлинности,
либо ошибку аутентификации стороны протокола.

%В протоколе BMQV признак \texttt{ОШИБКА} 
%может дополнительно возвращаться, если одна из сторон 
%вырабатывает нулевую одноразовую подпись.
%Вероятность этого события пренебрежимо мала.



