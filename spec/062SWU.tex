\section{Построение точки эллиптической кривой}\label{SWU}

\subsection{Входные и выходные данные}

Входными данными алгоритма построения точки эллиптической кривой
являются параметры $p$, $a$ и~$b$, которые описывают группу точек. 
Параметры должны удовлетворять требованиям, 
заданным в~\ref{COMMON.Params}. 
По модулю~$p$ определяется уровень стойкости~$\ell$ как минимальное 
натуральное, для которого~$p<2^{2\ell}$.

Кроме параметров эллиптической кривой,
входными данными алгоритма является слово~$X\in\{0,1\}^{2\ell}$.

Выходными данными является точка $W\in E_{a,b}^*(\FF_p)$, 
представляющая~$X$.

\subsection{Вспомогательные алгоритмы и переменные}

{\bf Алгоритм~\algname{belt-keywrap}}.
Используется алгоритм~\algname{belt-keywrap},
определенный в СТБ~34.101.31 (пункт~6.8.3).
Входными данными алгоритма являются
защищаемый ключ~$X\in\{0,1\}^{8*}$, заголовок $I\in\{0,1\}^{128}$
и ключ защиты~$\theta\in\{0,1\}^{256}$.
Выходными данными является
защищенный ключ~$Y\in\{0,1\}^{|X|+128}$.

{\bf Переменная $H$}.
Используется переменная~$H\in\{0,1\}^{2\ell+128}$.
Значение~$H$ должно быть уничтожено после использования.

{\bf Элементы $\FF_p$}.
Используются переменные $s,t,x_1,x_2,y\in\FF_p$.
Значения переменных должны быть уничтожены после использования.

\subsection{Алгоритм построения точки эллиптической кривой}\label{SWU.Alg}

Построение точки~$W$ состоит в выполнении следующих шагов:
\begin{enumerate}
\item
Установить $H\leftarrow \texttt{belt-keywrap}(X,0^{128},0^{256})$.
 
\item
Установить
$s\leftarrow \overline{H}\bmod p$.

\item
Установить
$t\leftarrow -s^2\bmod p$.

\item
Установить
$x_1\leftarrow -b(1+t+t^2)(a(t+t^2))^{p-2}\bmod p$.
%
% -b a^{-1}(1 + (t+t^2)^{-1})

\item
Установить
$x_2\leftarrow t x_1 \bmod p$.

\item
Установить
$y\leftarrow \left((x_1)^3+a x_1 + b\right)\bmod p$.

\item
Установить
$s\leftarrow s^3 y\bmod p$.

\item
Установить
$t\leftarrow y^{p-1-(p+1)/4}\bmod p$.

\item
Если $t^2 y\equiv 1\pmod{p}$, 
то $W\leftarrow(x_1,ty\bmod p)$,
иначе $W\leftarrow (x_2,st\bmod p)$.

\item
Возвратить $W$.

\if 0

\item
Установить
$x_W\leftarrow -\frac{b}{a}\left(1+\frac{1}{t^2+t}\right)\bmod p$.

\item
Установить 
$y_W\leftarrow (x_W^3+ax_W+b)\bmod p$.

\item
Если $\left(\frac{y_W}{p}\right)=1$, то 
\begin{enumerate}
\item
$y_W\leftarrow y_W^{(p+1)/4}\bmod p$;
\item
перейти к шагу 9.
\end{enumerate}
\item
Установить
$x_W\leftarrow t x_W\bmod p$.

\item
Установить
$y_W\leftarrow (x_W^3+ax_W+b)^{(p+1)/4}\bmod p$.

\item
Возвратить $W=(x_W,y_W)$.
\fi
\end{enumerate}

